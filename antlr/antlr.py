import sys
from antlr4 import *
from gen.Python3Lexer import Python3Lexer
from gen.Python3Parser import Python3Parser
from gen.Python3Listener import Python3Listener

def main(argv):
    input = FileStream(argv[1])
    lexer = Python3Lexer(input)
    stream = CommonTokenStream(lexer)

    """
    # print out the token parsing
    stream.fill()
    print("TOKENS")
    for token in stream.tokens:
        if token.text != '<EOF>':
            type_name = Python3Parser.symbolicNames[token.type]
            tabs = 5 - len(type_name) // 4
            sep = "\t" * tabs
            print("    %s%s%s" % (type_name, sep,
                                  token.text.replace(" ", u'\u23B5').replace("\n", u'\u2936')))
    """

    parser = Python3Parser(stream)
    tree = parser.stmt() # Start rule

    #output = open("output.txt","w")
    
    htmlPython3 = Python3Listener()
    print(htmlPython3.rule_uses)
    
    walker = ParseTreeWalker()
    walker.walk(htmlPython3, tree)

    print(htmlPython3.rule_uses)
        
    #output.close()  
    print(htmlPython3.rule_uses)  
    

if __name__ == '__main__':
    main(sys.argv)