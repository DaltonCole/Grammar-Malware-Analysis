import os
import json
import progressbar


def save_all_characters(benign_directory, malicious_directory, save_file):
	# Get benign code file paths
	file_paths = []
	for root, dirs, files in os.walk(benign_directory):
		for file in files:
			file_paths.append(os.path.join(root, file))

	# Get malicious code file paths
	for root, dirs, files in os.walk(malicious_directory):
		for file in files:
			file_paths.append(os.path.join(root, file))

	characters = set()

	with progressbar.ProgressBar(max_value=len(file_paths)) as bar:
		bar.update(0)
		count = 0
		for file in file_paths:
			count += 1
			bar.update(count)
			with open(file, 'r') as f:
				for line in f:
					try:
						for char in line:
							characters.add(char)
					except Exception as e:
						print(e)

	with open(save_file, 'w') as f:
		json.dump(list(characters), f)

if __name__ == '__main__':
	save_all_characters('/home/drc/Desktop/Research/javascript_web_crawler/scripts', '/home/drc/Desktop/javascript-malware-collection', './all_characters.json')